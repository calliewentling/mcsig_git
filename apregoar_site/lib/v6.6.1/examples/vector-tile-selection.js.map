{"version":3,"sources":["webpack:///./vector-tile-selection.js"],"names":["selection","country","stroke","color","width","fill","selectedCountry","vtLayer","declutter","source","maxZoom","format","idProperty","url","style","map","layers","target","view","center","zoom","multiWorld","selectionLayer","renderMode","getSource","feature","getId","selectElement","document","getElementById","on","event","value","type","getFeatures","pixel","then","features","length","changed","const","fid","indexOf"],"mappings":"2KAQIA,EAAY,GAEVC,EAAU,IAAI,KAAM,CACxBC,OAAQ,IAAI,IAAO,CACjBC,MAAO,OACPC,MAAO,IAETC,KAAM,IAAI,IAAK,CACbF,MAAO,yBAGLG,EAAkB,IAAI,KAAM,CAChCJ,OAAQ,IAAI,IAAO,CACjBC,MAAO,sBACPC,MAAO,IAETC,KAAM,IAAI,IAAK,CACbF,MAAO,0BAILI,EAAU,IAAI,IAAgB,CAClCC,WAAW,EACXC,OAAQ,IAAI,IAAiB,CAC3BC,QAAS,GACTC,OAAQ,IAAI,IAAI,CACdC,WAAY,WAEdC,IACE,wHAGJC,MAAOb,IAGHc,EAAM,IAAI,IAAI,CAClBC,OAAQ,CAACT,GACTU,OAAQ,MACRC,KAAM,IAAI,KAAK,CACbC,OAAQ,CAAC,EAAG,GACZC,KAAM,EACNC,YAAY,MAKVC,EAAiB,IAAI,IAAgB,CACzCP,IAAKA,EACLQ,WAAY,SACZd,OAAQF,EAAQiB,YAChBV,MAAO,SAAUW,GACf,GAAIA,EAAQC,UAAW1B,EACrB,OAAOM,KAKPqB,EAAgBC,SAASC,eAAe,QAE9Cd,EAAIe,GAAG,CAAC,QAAS,gBAAgB,SAAUC,GAEd,uBAAxBJ,EAAcK,OACE,gBAAfD,EAAME,MACiB,uBAAxBN,EAAcK,OACE,gBAAfD,EAAME,MAIV1B,EAAQ2B,YAAYH,EAAMI,OAAOC,MAAK,SAAUC,GAC9C,IAAKA,EAASC,OAGZ,OAFAtC,EAAY,QACZsB,EAAeiB,UAGjBC,IAAMf,EAAUY,EAAS,GACzB,GAAKZ,EAAL,CAGAe,IAAMC,EAAMhB,EAAQC,QAEgC,IAAhDC,EAAcK,MAAMU,QAAQ,kBAC9B1C,EAAY,IAGdA,EAAUyC,GAAOhB,EAEjBH,EAAeiB,mB","file":"vector-tile-selection.js","sourcesContent":["import MVT from '../src/ol/format/MVT.js';\nimport Map from '../src/ol/Map.js';\nimport VectorTileLayer from '../src/ol/layer/VectorTile.js';\nimport VectorTileSource from '../src/ol/source/VectorTile.js';\nimport View from '../src/ol/View.js';\nimport {Fill, Stroke, Style} from '../src/ol/style.js';\n\n// lookup for selection objects\nlet selection = {};\n\nconst country = new Style({\n  stroke: new Stroke({\n    color: 'gray',\n    width: 1,\n  }),\n  fill: new Fill({\n    color: 'rgba(20,20,20,0.9)',\n  }),\n});\nconst selectedCountry = new Style({\n  stroke: new Stroke({\n    color: 'rgba(200,20,20,0.8)',\n    width: 2,\n  }),\n  fill: new Fill({\n    color: 'rgba(200,20,20,0.4)',\n  }),\n});\n\nconst vtLayer = new VectorTileLayer({\n  declutter: true,\n  source: new VectorTileSource({\n    maxZoom: 15,\n    format: new MVT({\n      idProperty: 'iso_a3',\n    }),\n    url:\n      'https://ahocevar.com/geoserver/gwc/service/tms/1.0.0/' +\n      'ne:ne_10m_admin_0_countries@EPSG%3A900913@pbf/{z}/{x}/{-y}.pbf',\n  }),\n  style: country,\n});\n\nconst map = new Map({\n  layers: [vtLayer],\n  target: 'map',\n  view: new View({\n    center: [0, 0],\n    zoom: 2,\n    multiWorld: true,\n  }),\n});\n\n// Selection\nconst selectionLayer = new VectorTileLayer({\n  map: map,\n  renderMode: 'vector',\n  source: vtLayer.getSource(),\n  style: function (feature) {\n    if (feature.getId() in selection) {\n      return selectedCountry;\n    }\n  },\n});\n\nconst selectElement = document.getElementById('type');\n\nmap.on(['click', 'pointermove'], function (event) {\n  if (\n    (selectElement.value === 'singleselect-hover' &&\n      event.type !== 'pointermove') ||\n    (selectElement.value !== 'singleselect-hover' &&\n      event.type === 'pointermove')\n  ) {\n    return;\n  }\n  vtLayer.getFeatures(event.pixel).then(function (features) {\n    if (!features.length) {\n      selection = {};\n      selectionLayer.changed();\n      return;\n    }\n    const feature = features[0];\n    if (!feature) {\n      return;\n    }\n    const fid = feature.getId();\n\n    if (selectElement.value.indexOf('singleselect') === 0) {\n      selection = {};\n    }\n    // add selected feature to lookup\n    selection[fid] = feature;\n\n    selectionLayer.changed();\n  });\n});\n"],"sourceRoot":""}