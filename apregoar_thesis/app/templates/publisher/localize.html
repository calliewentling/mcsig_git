<!-- https://docs.mapbox.com/mapbox-gl-js/example/mapbox-gl-draw/ -->
<!--
<!DOCTYPE html>
<html>
<head>
    -->

    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.7.0/mapbox-gl.css" rel="stylesheet"> 
<script src="https://api.mapbox.com/mapbox-gl-js/v2.7.0/mapbox-gl.js"></script>



<style>
    /*https://www.w3schools.com/howto/howto_css_split_screen.asp*/
    /*Control the left side*/
    .left {
        left: 0;
        width: 38%;
        position: fixed;
        z-index: 1;
        overflow-x: hidden;
    }

    /*Control the right side*/
    .right {
        right: 0;
        width: 60%;
        position: fixed;
        z-index: 1;
        overflow-x: hidden;
    }

    .calculation-box {
        height: 100px;
        width: 150px;
        position: absolute;
        bottom: 40px;
        right: 10px;
        background-color: rgb(255, 255, 255);
        padding: 15px;
        text-align: center;
    }

    .p {
        font-family: 'Open Sans';
        margin: 0;
        font-size: 13px;
    }
    #mapDesign { position: relative; top: 0; right: 0; width: 100%; height:100% }

</style>
    


<script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>
<script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.2.2/mapbox-gl-draw.js"></script>
<link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.2.2/mapbox-gl-draw.css" type="text/css">
<!--<link href="../../static/css/publish.css" rel="stylesheet"> -->

{% extends "publisher/templates/publisher_template.html" %}

{% block title %}Localize{% endblock %}

{% block main %}


<!--<script src="{{ url_for('static', filename='js/create.js') }}"></script> -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>


<script>
    $(document).ready(function(){
        $('[data-toggle="tooltip"]').tooltip();
    });
</script>

<div class="container">
  <div class="row">
    <div class="col">
    
        <h1>Localizar as Notícias</h1>
        <h3>{{ story["title"] }}</h3>

        <div>
            <p> Definir uma instância (tempo e sítio) da notícia
                <a 
                    href="#" 
                    data-toggle="tooltip" 
                    title="Cada instância é uma oportunidade de elaborar onde e quando uma coisa está a acontacer. Cada notícia pode ter algumas notícias, e cada instância pode ter alguns sítios (polígonos). Escreve um ou mas polígonos aqui, dar um nome (não precisa de ser oficial) e uma descrição. Definir as datas do início e o fim, um tipo de interval temporal, e afinal um descrição.">
                    <span class="material-icons">info</span>
                </a>
            </p>
        </div>
        
        <div id="eGazMap" style="display:block">
            <div id="map" class="map"></div>
        </div>
        <br> 
        <!-- TOGGLE -->
        <div class="container1">
            <label class="switch">
                <input id ="tswitch" type="checkbox" onclick = "toggleLocalization()">
                <span class="slider round"></span>
            </label>
            <div id="toggleMode"><p>Ver localizações</p></div>
        </div>

        <!-- DESIGN NEW (UGAZ) -->
        <div id="newUgaz" style="display:none">
            <h5>Desenhar uns localizações novos</h5>
            <!--<label for="type">Geometry type &nbsp;</label> -->
            <select id="type" style="display:none">
                <option value="Polygon" select="selected">Polygon</option>
            </select>   
        
            <p>Número dos polígonos:</p>
            <div id="calculated-area" style="color:red"></div> 
            <div id="selectName">
                <input type="text" id="pName" name="pName" placeholder="Nome do sítio" required>
                <span class="error" aria-live="polite"></span>
            </div>
            <div id="selectGeom" style="color:red" ></div>
        </div>
        

        <div class="card" id="save_instance" >             
            <h4>Localização/ões</h4>
            <form method="POST" action="review">

                 
                <button type="button" class="btn btn-primary" onclick="vizEgaz('eGazFreg')">Prever</button>
                <!--
                {% if eGazF|length > 0 %}
                    <div id="listGazF" class="dropdown-check-list" tabindex="100">
                        <span class="anchor">Carregar freguesias existentes</span>
                        <ul id="itemsF" class="items">
                            {% for eGazItem in eGazF %}
                                <li><input type="checkbox" name="eGazFreg" value="{{ eGazItem.e_ids }}">{{ eGazItem.name }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                {% else %}
                    <p><em>Desculpa, as freguesias não estão carregadas.</em></p>
                {% endif %}
                -->

                {% if eGazC|length > 0 %}
                    <div id="listGazC" class="dropdown-check-list" tabindex="100">
                        <span class="anchor">Carregar Concelhos existentes</span>
                        <ul id="itemsC" class="items">
                            {% for eGazItem in eGazC %}
                                <li><input type="checkbox" name="eGazConcelho" value="{{ eGazItem.e_ids }}">{{ eGazItem.name }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                {% else %}
                    <p><em>Desculpa, as freguesias não estão carregadas.</em></p>
                {% endif %}

                 
                  
            </form>
                


            <br>                       
            <div id="selectDesc">
                <input type="text" id="pDesc" name="pDesc" placeholder="Descrição do sítio">
            </div>
            <br>
            <div>
                <strong>Hora(s)</strong>
                <div>
                    <label for="allday_y">Todo o dia</label><input type="radio" id="allday_y" name="allDay" value="allday_y" onClick="timeDefD()" checked="checked">
                    <label for="allday_n">Horas específicas</label><input type="radio" id="allday_n" name="allDay" value="allday_n" onClick="timeDefH()">
                        
                </div>
                <div>
                    <input type="date" id="tBegin" name="tBegin" required> <input type="date" id="tEnd" name="tEnd"  required>
                </div>
                <br>
                <div>
                    <input type="text" id="tDesc" name="tDesc" placeholder="Temporal description">
                </div>
            </div>
            <br>
            <div id="successAnnouncement"></div>
            <div id="formButton"></div>
        </div>
        <br>
        <div class="card">
            <div id="btnReturn"></div>
            <button type="button" class="btn btn-primary" onclick=limparTudo()>Limpar tudo</button>
        </div>

        

    </div>
</div>
<div id="mapDesign"></div>
<!-- Load the `mapbox-gl-geocoder` plugin. -->
<script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.2/mapbox-gl-geocoder.min.js"></script>
<link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.2/mapbox-gl-geocoder.css" type="text/css">

<script>
    //////// STORY INFO ///////
    // Loading story info
    var sID = '{{ sID }}';
    console.log("sID is: ");
    console.log(sID);
    var mapStoryFilter = "s_id="+sID;
    console.log("Map Story filter: ",mapStoryFilter);
    var mapEAGazFilter = "";
    const eGazAll = "{{ eGazF }}";
</script>
<script src="{{ url_for('static', filename='js/localize.js') }}"></script>


{% endblock %}